# Makefile to install help files
# $Id: Makefile.in,v 1.10 2005/09/16 14:07:25 knight Exp $

INSTALL=	@INSTALL@
INSTALL_DATA=	@INSTALL_DATA@
RM=		@RM@

prefix=		@prefix@
exec_prefix=	@execprefix@
uhelpdir=	${prefix}/help/users
ohelpdir=	${prefix}/help/opers

SYMLINKS=   topic accept cmode admin names links away whowas \
		version kick who invite quit join list nick oper part \
		time motd userhost users whois ison lusers user help \
		pass error challenge knock ping pong flags
all:
build:
clean:
depend:

index:
	@echo building index files
	rm -f ../../help/users/index
	@for help in ../../help/users/*; do \
		if [ -f $$help ]; then \
			echo $$help >> ../../help/users/index.tmp; \
		fi \
	done
	@for help in $(SYMLINKS); do \
		echo $$help >> ../../help/users/index.tmp; \
	done
	echo 'Help topics available to users:' > ../../help/users/index
	echo '' >> ../../help/users/index
	cat ../../help/users/index.tmp \
		| sed -e 's|^users/||' \
		| sed -e 's|^../../help/users/||' \
		| sort -u \
		| tr a-z A-Z \
		| expand \
		>> ../../help/users/index
	rm -f ../../help/users/index.tmp
	rm -f ../../help/opers/index.tmp
	rm -f ../../help/opers/index
	@for help in opers/*; do \
		if [ -f $$help ]; then \
			echo $$help >> ../../help/opers/index.tmp; \
		fi \
	done
	@for help in ../../help/opers/*; do \
		if [ -f $$help ]; then \
			echo $$help >> ../../help/opers/index.tmp; \
		fi \
	done
	echo 'Help topics available to opers:' > ../../help/opers/index
	echo '' >> ../../help/opers/index
	cat ../../help/opers/index.tmp \
		| sed -e 's|^opers/||' \
		| sed -e 's|^../../help/opers/||' \
		| sort -u \
		| tr a-z A-Z \
		| expand \
		>> ../../help/opers/index
	rm -f ../../help/opers/index.tmp

install: index
	@echo installing help files...
	-@if test ! -d $(prefix)/help; then \
		echo "mkdir $(prefix)/help"; \
		mkdir $(prefix)/help; \
		echo "mkdir $(prefix)/help/users"; \
		mkdir $(prefix)/help/users; \
		echo "mkdir $(prefix)/help/opers"; \
		mkdir $(prefix)/help/opers; \
	fi
	@for help in opers/*; do \
	if [ -f $$help ]; then \
		${INSTALL_DATA} $$help $(ohelpdir); \
	fi \
	done
	@for help in users/*; do \
	if [ -f $$help ]; then \
		$(INSTALL_DATA) $$help $(uhelpdir); \
	fi \
	done
	@for link in $(SYMLINKS); do \
		rm -f $(uhelpdir)/$$link; \
		ln -s $(ohelpdir)/$$link $(uhelpdir); \
	done

distclean:
	${RM} -f Makefile

depend:
