#
# Makefile.in for servlink/src
#
# $Id: Makefile.in,v 1.19 2003/05/18 19:26:31 joshk Exp $
#

CC              = @CC@
INSTALL         = @INSTALL@
INSTALL_BIN     = @INSTALL_PROGRAM@
CFLAGS          = @IRC_CFLAGS@
LDFLAGS         = @LDFLAGS@
MKDEP           = @MKDEP@
STDOUT		= @STDOUT@
MV              = @MV@
RM              = @RM@
SED		= @SED@
prefix          = @prefix@
exec_prefix     = @exec_prefix@
bindir          = @bindir@
libexecdir      = @libexecdir@
sysconfdir      = @sysconfdir@
localstatedir   = @localstatedir@

SSL_LIBS	= @SSL_LIBS@
SSL_INCLUDES	= @SSL_INCLUDES@
ZIP_LIB		= @ZLIB_LD@

IRCDLIBS        = @LIBS@ $(SSL_LIBS) $(ZIP_LIB)

INCLUDES        = -I../include -I. $(SSL_INCLUDES)
CPPFLAGS        = ${INCLUDES} @CPPFLAGS@

PROGS		= servlink

SOURCES =     \
  servlink.c  \
  io.c        \
  control.c
  

OBJECTS = ${SOURCES:.c=.o}

all: servlink

build: all

servlink: ${OBJECTS}
	${CC} ${CFLAGS} ${LDFLAGS} -o $@ ${OBJECTS} ${IRCDLIBS}

install: build
	mkdir -p $(bindir)
	@for i in $(PROGS); do \
                if test -f $(bindir)/$$i; then \
                        echo $(MV) $(bindir)/$$i $(bindir)/$$i.old; \
                        $(MV) $(bindir)/$$i $(bindir)/$$i.old; \
                fi; \
                echo $(INSTALL_BIN) $$i $(bindir); \
                $(INSTALL_BIN) $$i $(bindir); \
        done

.c.o:
	${CC} ${CPPFLAGS} ${CFLAGS} -c $<

depend:
	${MKDEP} ${CPPFLAGS} ${SOURCES} ${STDOUT}
	@${SED} -e '/^# Autogenerated - do not delete/,$$d' <Makefile >Makefile.depend
	@echo '# Autogenerated - do not delete' >>Makefile.depend
	@echo 'include .depend' >> Makefile.depend
	@${MV} Makefile.depend Makefile

clean:
	${RM} -f *.o *~ *core servlink

distclean: clean
	${RM} -f Makefile .depend

.PHONY: clean distclean
